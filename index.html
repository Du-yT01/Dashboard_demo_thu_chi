<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>B√°o C√°o Qu·∫£n Tr·ªã Ng√¢n S√°ch & Thu - Chi</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/3.9.1/chart.min.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Be+Vietnam+Pro:wght@300;400;500;600;700&display=swap&subset=vietnamese" rel="stylesheet">
    <style>
        :root {
            --primary: #DC2626;
            --primary-dark: #B91C1C;
            --primary-light: #FEE2E2;
            --secondary: #EF4444;
            --bg-dark: #1F2937;
            --bg-light: #F9FAFB;
            --text-primary: #111827;
            --text-secondary: #6B7280;
            --border: #E5E7EB;
            --success: #10B981;
            --warning: #F59E0B;
            --info: #3B82F6;
        }

        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { font-family: 'Be Vietnam Pro', 'Segoe UI', Tahoma, Arial, sans-serif; background: var(--bg-light); color: var(--text-primary); }

        .app-wrapper {
            display: flex;
            min-height: 100vh;
            background: var(--bg-light);
        }

        .sidebar {
            background: linear-gradient(180deg, var(--bg-dark) 0%, #111827 100%);
            color: white;
            padding: 24px 16px;
            position: fixed;
            left: 0;
            top: 0;
            height: 100vh;
            width: 260px;
            overflow-y: auto;
            box-shadow: 2px 0 8px rgba(0,0,0,0.15);
            z-index: 100;
        }

        .logo {
            display: flex;
            align-items: center;
            gap: 12px;
            margin-bottom: 28px;
            padding: 12px;
        }

        .logo-icon {
            width: 40px;
            height: 40px;
            background: linear-gradient(135deg, var(--primary) 0%, var(--secondary) 100%);
            border-radius: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 18px;
        }

        .logo-text { font-weight: 700; line-height: 1.2; font-size: 13px; }

        .nav-item {
            padding: 12px 16px;
            margin-bottom: 4px;
            cursor: pointer;
            border-radius: 8px;
            transition: all 0.3s;
            font-size: 13px;
            font-weight: 500;
            color: #9CA3AF;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .nav-item:hover { background: rgba(255,255,255,0.1); color: white; }
        .nav-item.active {
            background: linear-gradient(135deg, var(--primary) 0%, var(--secondary) 100%);
            color: white;
            box-shadow: 0 4px 12px rgba(220,38,38,0.3);
        }

        .main-content {
            flex: 1;
            margin-left: 260px;
            padding: 36px 52px;
            width: calc(100% - 260px);
            overflow-x: hidden;
        }

        .page { display: none; animation: fadeIn 0.4s; }
        .page.active { display: block; }

        @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }

        .page-header {
            margin-bottom: 28px;
            padding-bottom: 16px;
            border-bottom: 2px solid var(--border);
        }

        .page-title { font-size: 30px; font-weight: 700; margin-bottom: 6px; }
        .page-subtitle { color: var(--text-secondary); font-size: 14px; }

        .section-title {
            font-size: 15px;
            font-weight: 700;
            color: var(--text-primary);
            margin: 18px 0 12px;
        }

        .kpi-grid {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 18px;
            margin-bottom: 26px;
        }

        .kpi-grid.page1-kpis { grid-template-columns: repeat(3, 1fr); }
        .kpi-grid.page2-quad { grid-template-columns: repeat(2, 1fr); }
        .kpi-grid.page2-approval {
            grid-template-columns: 1fr;
            gap: 12px;
            height: 100%;
            align-content: stretch;
        }
        .kpi-grid.page3-kpis { grid-template-columns: repeat(4, 1fr); }
        .kpi-grid.page4-kpis { grid-template-columns: repeat(4, 1fr); }

        .kpi-card {
            background: white;
            border-radius: 12px;
            padding: 18px;
            border-left: 4px solid var(--primary);
            box-shadow: 0 2px 8px rgba(0,0,0,0.08);
        }

        .kpi-label { font-size: 12px; color: var(--text-secondary); font-weight: 600; margin-bottom: 6px; }
        .kpi-value { font-size: 22px; font-weight: 700; color: var(--text-primary); }
        .kpi-change { font-size: 12px; margin-top: 6px; padding: 4px 8px; border-radius: 4px; display: inline-block; }
        .kpi-change.positive { background: #D1FAE5; color: var(--success); font-weight: 600; }
        .kpi-change.negative { background: var(--primary-light); color: var(--primary); font-weight: 600; }
        .kpi-sub { font-size: 11px; color: var(--text-secondary); margin-top: 6px; }
        .kpi-delta.positive { color: var(--success); font-weight: 600; }
        .kpi-delta.negative { color: var(--primary); font-weight: 600; }

        .chart-grid {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 20px;
            margin-bottom: 26px;
        }

        .chart-grid.page1-charts {
            grid-template-columns: repeat(2, 1fr);
        }

        .chart-grid.two { grid-template-columns: repeat(2, 1fr); }
        .chart-grid.page3-two { display: flex; gap: 20px; align-items: stretch; }
        .chart-grid.single { grid-template-columns: 1fr; }

        .chart-card {
            background: white;
            border-radius: 12px;
            padding: 18px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.08);
        }

        .chart-title {
            font-size: 14px;
            font-weight: 600;
            margin-bottom: 12px;
            color: var(--text-primary);
            padding-bottom: 8px;
            border-bottom: 1px solid var(--border);
        }

        .chart-container {
            position: relative;
            height: 300px;
        }

        .chart-container.small { height: 240px; }
        .chart-container.tall { height: 380px; }
        .chart-container.gauge { height: 300px; }

        .stacked-col {
            flex: 0 0 380px;
            display: flex;
            flex-direction: column;
            gap: 18px;
        }

        .stacked-col .chart-card {
            display: flex;
            flex-direction: column;
            flex: 1 1 0;
        }

        .stacked-col .chart-container {
            flex: 1 1 0;
            height: auto;
            min-height: 140px;
        }

        .table-col {
            flex: 1;
            display: flex;
        }

        .table-col .chart-card {
            width: 100%;
            display: flex;
            flex-direction: column;
        }

        .table-col .chart-card > div + div {
            flex: 1 1 auto;
            overflow-x: auto;
            max-height: 650px;
        }

        .page4-two .stacked-col .chart-card:first-child { display: none; }

        .compare-row {
            display: grid;
            grid-template-columns: 1fr 1.2fr;
            gap: 20px;
            margin-bottom: 24px;
            align-items: stretch;
        }

        .compare-row .chart-card {
            display: flex;
            flex-direction: column;
        }

        .compare-row .chart-container {
            flex: 1 1 auto;
            height: auto;
            min-height: 220px;
        }

        .approval-row {
            grid-template-columns: 2fr 1fr;
            gap: 22px;
        }

        .approval-row .filter-panel {
            max-height: none;
            overflow: auto;
            border: 1px solid var(--border);
            background: linear-gradient(180deg, #ffffff 0%, #fdf2f2 100%);
            padding: 18px;
            gap: 14px;
        }

        .approval-row .kpi-card {
            min-height: 120px;
            border-left-color: var(--secondary);
            padding: 14px 16px;
            display: flex;
            flex-direction: column;
            justify-content: space-between;
        }

        .approval-row .kpi-label {
            color: #B91C1C;
            background: var(--primary-light);
            display: inline-flex;
            padding: 3px 8px;
            border-radius: 999px;
            letter-spacing: 0.3px;
            text-transform: uppercase;
            font-size: 10px;
        }

        .approval-row .kpi-value {
            font-size: 22px;
        }

        .approval-row .filter-label {
            text-transform: uppercase;
            letter-spacing: 0.4px;
            font-size: 11px;
            color: var(--text-secondary);
        }

        .approval-row .filter-checklist {
            background: #ffffff;
            border: 1px solid var(--border);
            border-radius: 10px;
            padding: 8px;
        }

        .approval-row .filter-item {
            border: 1px solid #E5E7EB;
            background: #F9FAFB;
        }

        .kpi-value-row {
            display: flex;
            align-items: center;
            justify-content: space-between;
            gap: 12px;
        }

        .kpi-side {
            text-align: right;
            font-size: 11px;
            min-width: 120px;
        }

        .kpi-side .kpi-sub {
            margin-top: 2px;
        }

        .toggle-group {
            display: inline-flex;
            gap: 6px;
            background: white;
            border-radius: 10px;
            padding: 6px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.08);
            margin-bottom: 18px;
        }

        .toggle-btn {
            border: none;
            background: transparent;
            padding: 8px 14px;
            font-size: 12px;
            border-radius: 8px;
            cursor: pointer;
            color: var(--text-secondary);
            font-weight: 600;
        }

        .toggle-btn.active {
            background: var(--primary);
            color: white;
        }

        .filter-panel {
            background: white;
            border-radius: 12px;
            padding: 16px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.08);
            display: flex;
            flex-direction: column;
            height: 100%;
        }

        .filter-group { margin-bottom: 12px; display: flex; flex-direction: column; }
        .filter-label { font-size: 12px; font-weight: 600; margin-bottom: 6px; color: var(--text-primary); }
        .filter-select {
            width: 100%;
            padding: 8px 10px;
            border: 1px solid var(--border);
            border-radius: 8px;
            font-size: 12px;
        }

        .filter-checklist {
            display: grid;
            grid-template-columns: repeat(2, minmax(0, 1fr));
            gap: 6px;
            max-height: 130px;
            overflow-y: auto;
            padding-right: 4px;
        }

        .filter-checklist.tall { max-height: 160px; }

        .filter-item {
            display: flex;
            align-items: center;
            gap: 6px;
            font-size: 11px;
            background: var(--bg-light);
            border-radius: 6px;
            padding: 6px 8px;
        }

        .filter-item input { accent-color: var(--primary); }

        .matrix-table {
            width: 100%;
            border-collapse: collapse;
            font-size: 12px;
            background: white;
        }

        .matrix-table thead {
            background: linear-gradient(135deg, var(--primary-light) 0%, rgba(220,38,38,0.05) 100%);
            position: sticky;
            top: 0;
        }

        .matrix-table th {
            padding: 10px 8px;
            text-align: left;
            font-weight: 600;
            color: var(--text-primary);
            border-bottom: 2px solid var(--border);
            white-space: nowrap;
        }

        .matrix-table td {
            padding: 8px 8px;
            border-bottom: 1px solid var(--border);
            text-align: right;
        }

        .matrix-table td:first-child {
            text-align: left;
            font-weight: 500;
            color: var(--text-primary);
            background: var(--bg-light);
            position: sticky;
            left: 0;
        }

        .matrix-table .row-group td {
            font-weight: 700;
            background: var(--primary-light);
            color: var(--text-primary);
            text-align: left;
        }

        .matrix-table .row-child td {
            font-size: 11px;
        }

        .matrix-table .row-child td:first-child {
            padding-left: 18px;
        }

        .risk-high { color: #DC2626; font-weight: 600; }
        .risk-medium { color: #D97706; font-weight: 600; }
        .risk-low { color: #059669; font-weight: 600; }

        #page3 > .kpi-grid.page3-kpis,
        #page3 > .chart-grid.single,
        #page3 > .chart-grid.two,
        #page3 > .chart-card {
            display: none;
        }

        #page4 > .kpi-grid.page4-kpis,
        #page4 > .chart-grid,
        #page4 > .chart-card {
            display: none;
        }

        @media (max-width: 1400px) {
            .chart-grid { grid-template-columns: repeat(2, 1fr); }
            .kpi-grid { grid-template-columns: repeat(2, 1fr); }
            .kpi-grid.page1-kpis { grid-template-columns: repeat(2, 1fr); }
            .kpi-grid.page3-kpis, .kpi-grid.page4-kpis { grid-template-columns: repeat(2, 1fr); }
            .compare-row { grid-template-columns: 1fr; }
        }

        @media (max-width: 1200px) {
            .chart-grid.page3-two { flex-direction: column; }
            .chart-grid.page3-two > div:first-child { flex: 0 0 auto; width: 100%; }
            .chart-container.tall { height: 320px; }
        }

        @media (max-width: 900px) {
            .sidebar { position: relative; width: 100%; height: auto; }
            .main-content { margin-left: 0; width: 100%; padding: 24px; }
            .chart-grid, .chart-grid.two { grid-template-columns: 1fr; }
            .kpi-grid { grid-template-columns: 1fr; }
        }
    </style>
</head>
<body>
    <div class="app-wrapper">
        <nav class="sidebar">
            <div class="logo">
                <div class="logo-icon">üìä</div>
                <div class="logo-text">QU·∫¢N TR·ªä<br>NG√ÇN S√ÅCH</div>
            </div>
            <div class="nav-item active" data-page="1"><span>üìä</span> T·ªïng Quan</div>
            <div class="nav-item" data-page="2"><span>‚úÖ</span> Duy·ªát Ng√¢n S√°ch</div>
            <div class="nav-item" data-page="3"><span>üí∞</span> T·ªïng Thu</div>
            <div class="nav-item" data-page="4"><span>üí∏</span> T·ªïng Chi</div>
        </nav>

        <main class="main-content">
            <div id="page1" class="page active">
                <div class="page-header">
                    <h1 class="page-title">T·ªïng Quan Danh M·ª•c D·ª± √Ån</h1>
                    <p class="page-subtitle">ƒê√°nh gi√° nhanh ng√¢n s√°ch v√† hi·ªáu qu·∫£ thu chi to√†n c√¥ng ty</p>
                </div>

                <div class="kpi-grid page1-kpis">
                    <div class="kpi-card"><div class="kpi-label">Ng√¢n s√°ch t·ªïng - Thu</div><div class="kpi-value">560.0 T·ª∑</div><div class="kpi-change positive">Duy·ªát 12/2025</div></div>
                    <div class="kpi-card"><div class="kpi-label">Ng√¢n s√°ch t·ªïng - Chi</div><div class="kpi-value">390.0 T·ª∑</div><div class="kpi-change positive">Duy·ªát 12/2025</div></div>
                    <div class="kpi-card"><div class="kpi-label">T·ªïng th·ª±c thu</div><div class="kpi-value">545.0 T·ª∑</div><div class="kpi-change positive">+4.8% so v·ªõi k·ª≥ tr∆∞·ªõc</div></div>
                    <div class="kpi-card"><div class="kpi-label">Ng√¢n s√°ch chi ti·∫øt - Thu</div><div class="kpi-value">560.0 T·ª∑</div><div class="kpi-change positive">Duy·ªát 12/2025</div></div>
                    <div class="kpi-card"><div class="kpi-label">Ng√¢n s√°ch chi ti·∫øt - Chi</div><div class="kpi-value">390.0 T·ª∑</div><div class="kpi-change positive">Duy·ªát 12/2025</div></div>
                    <div class="kpi-card"><div class="kpi-label">T·ªïng th·ª±c chi</div><div class="kpi-value">382.0 T·ª∑</div><div class="kpi-change negative">+6.1% so v·ªõi k·ª≥ tr∆∞·ªõc</div></div>
                </div>

                <div class="section-title">Ng√¢n s√°ch theo d·ª± √°n</div>
                <div class="chart-grid two">
                    <div class="chart-card"><div class="chart-title">Ng√¢n s√°ch t·ªïng vs chi ti·∫øt - Thu</div><div class="chart-container"><canvas id="chartP1Revenue"></canvas></div></div>
                    <div class="chart-card"><div class="chart-title">Ng√¢n s√°ch t·ªïng vs chi ti·∫øt - Chi</div><div class="chart-container"><canvas id="chartP1Cost"></canvas></div></div>
                </div>

                <div class="section-title">Th·ª±c t·∫ø vs ng√¢n s√°ch</div>
                <div class="chart-grid two">
                    <div class="chart-card"><div class="chart-title">Thu theo d·ª± √°n vs Ng√¢n s√°ch (k√®m t·ª∑ l·ªá)</div><div class="chart-container"><canvas id="chartP1RevenueActual"></canvas></div></div>
                    <div class="chart-card"><div class="chart-title">Chi theo d·ª± √°n vs Ng√¢n s√°ch (k√®m t·ª∑ l·ªá)</div><div class="chart-container"><canvas id="chartP1CostActual"></canvas></div></div>
                </div>
            </div>

            <div id="page2" class="page">
                <div class="page-header">
                    <h1 class="page-title">ƒê√°nh Gi√° & Duy·ªát Ng√¢n S√°ch</h1>
                    <p class="page-subtitle">So s√°nh Ver 0 v√† Ver Latest ƒë·ªÉ quy·∫øt ƒë·ªãnh ƒëi·ªÅu ch·ªânh</p>
                </div>

                <div class="toggle-group">
                    <button class="toggle-btn active" data-mode="total">Ng√¢n s√°ch t·ªïng (1-3)</button>
                    <button class="toggle-btn" data-mode="detail">Ng√¢n s√°ch chi ti·∫øt (1-4)</button>
                </div>

                <div class="section-title">So s√°nh Thu</div>
                <div class="compare-row">
                    <div class="kpi-grid page2-quad">
                        <div class="kpi-card"><div class="kpi-label">T·ªïng thu (Ver 0)</div><div class="kpi-value" id="p2RevenueVer0">0</div><div class="kpi-change positive">C∆° s·ªü</div></div>
                        <div class="kpi-card"><div class="kpi-label">T·ªïng thu (Ver Latest)</div><div class="kpi-value" id="p2RevenueLatest">0</div><div class="kpi-change positive">Hi·ªán t·∫°i</div></div>
                        <div class="kpi-card"><div class="kpi-label">Ch√™nh l·ªách</div><div class="kpi-value" id="p2RevenueDelta">0</div><div class="kpi-change positive">Latest - Ver 0</div></div>
                        <div class="kpi-card"><div class="kpi-label">% ch√™nh l·ªách</div><div class="kpi-value" id="p2RevenueDeltaPct">0</div><div class="kpi-change positive">TƒÉng</div></div>
                    </div>
                    <div class="chart-card"><div class="chart-title">So s√°nh Thu theo Version (Theo d·ª± √°n)</div><div class="chart-container"><canvas id="chartP2Revenue"></canvas></div></div>
                </div>

                <div class="section-title">So s√°nh Chi</div>
                <div class="compare-row">
                    <div class="kpi-grid page2-quad">
                        <div class="kpi-card"><div class="kpi-label">T·ªïng chi (Ver 0)</div><div class="kpi-value" id="p2CostVer0">0</div><div class="kpi-change positive">C∆° s·ªü</div></div>
                        <div class="kpi-card"><div class="kpi-label">T·ªïng chi (Ver Latest)</div><div class="kpi-value" id="p2CostLatest">0</div><div class="kpi-change negative">Hi·ªán t·∫°i</div></div>
                        <div class="kpi-card"><div class="kpi-label">Ch√™nh l·ªách</div><div class="kpi-value" id="p2CostDelta">0</div><div class="kpi-change negative">Latest - Ver 0</div></div>
                        <div class="kpi-card"><div class="kpi-label">% ch√™nh l·ªách</div><div class="kpi-value" id="p2CostDeltaPct">0</div><div class="kpi-change negative">TƒÉng</div></div>
                    </div>
                    <div class="chart-card"><div class="chart-title">So s√°nh Chi theo Version (Theo d·ª± √°n)</div><div class="chart-container"><canvas id="chartP2Cost"></canvas></div></div>
                </div>

                <div class="section-title">B·∫£ng chi ti·∫øt ƒëi·ªÅu ch·ªânh</div>
                <div class="chart-card">
                    <div class="chart-title">Chi ti·∫øt theo h·∫°ng m·ª•c</div>
                    <div style="overflow-x: auto; max-height: 380px;">
                        <table class="matrix-table">
                            <thead>
                                <tr>
                                    <th>H·∫°ng m·ª•c</th>
                                    <th>Ver 0</th>
                                    <th>Ver Latest</th>
                                    <th>Ch√™nh l·ªách</th>
                                    <th>% ch√™nh l·ªách</th>
                                    <th>Ver ƒëi·ªÅu ch·ªânh</th>
                                </tr>
                            </thead>
                            <tbody id="p2DetailBody"></tbody>
                        </table>
                    </div>
                </div>

                <div class="section-title">ƒêi·ªÅu ch·ªânh & duy·ªát ng√¢n s√°ch</div>
                <div class="compare-row approval-row">
                    <div class="filter-panel">
                        <div class="filter-group">
                            <div class="filter-label">D·ª± √°n</div>
                                <select class="filter-select">
                                <option>DA Alpha</option>
                                <option>DA Beta</option>
                                <option>DA Gamma</option>
                                <option>DA Delta</option>
                                <option>DA Epsilon</option>
                            </select>
                        </div>
                        <div class="filter-group">
                            <div class="filter-label">H·∫°ng m·ª•c t·∫ßng 1</div>
                            <div class="filter-checklist">
                                <label class="filter-item"><input type="checkbox" checked> THU.01 - Thu t·ª´ Ch·ªß ƒê·∫ßu T∆∞</label>
                                <label class="filter-item"><input type="checkbox" checked> THU.02 - Thu Ho·∫°t ƒê·ªông T√†i Ch√≠nh</label>
                                <label class="filter-item"><input type="checkbox" checked> THU.03 - Thu t·ª´ Ngu·ªìn Kh√°c</label>
                                <label class="filter-item"><input type="checkbox" checked> THU.04 - Thu Kh√°c</label>
                                <label class="filter-item"><input type="checkbox" checked> CHI.01 - Chi cho ph√°p l√Ω d·ª± √°n</label>
                                <label class="filter-item"><input type="checkbox" checked> CHI.02 - Chi cho ki·∫øn thi·∫øt c∆° b·∫£n</label>
                                <label class="filter-item"><input type="checkbox" checked> CHI.03 - Chi cho c√¥ng t√°c b√°n h√†ng</label>
                                <label class="filter-item"><input type="checkbox" checked> CHI.04 - Chi c√¥ng t√°c chu·∫©n b·ªã</label>
                                <label class="filter-item"><input type="checkbox" checked> CHI.05 - Chi c√¥ng t√°c thi·∫øt b·ªã</label>
                                <label class="filter-item"><input type="checkbox" checked> CHI.06 - Chi nh√¢n c√¥ng & th·∫ßu ph·ª•</label>
                                <label class="filter-item"><input type="checkbox" checked> CHI.07 - Chi v·∫≠t t∆∞ & NCC</label>
                                <label class="filter-item"><input type="checkbox" checked> CHI.08 - Chi cho ho·∫°t ƒë·ªông tr·ª±c ti·∫øp</label>
                            </div>
                        </div>
                        <div class="filter-group">
                            <div class="filter-label">H·∫°ng m·ª•c t·∫ßng 2</div>
                            <div class="filter-checklist tall">
                                <label class="filter-item"><input type="checkbox" checked> THU.01.01 - T∆∞ v·∫•n</label>
                                <label class="filter-item"><input type="checkbox" checked> THU.01.02 - Rao s·ª±</label>
                                <label class="filter-item"><input type="checkbox" checked> THU.01.03 - B·∫£n quy·ªÅn & Kh√°c</label>
                                <label class="filter-item"><input type="checkbox" checked> THU.02.01 - L√£i su·∫•t ng√¢n h√†ng</label>
                                <label class="filter-item"><input type="checkbox" checked> THU.02.02 - C·ªï t·ª©c & Kh√°c</label>
                                <label class="filter-item"><input type="checkbox" checked> THU.03.01 - B·∫£o t√≠n v·ªá th·∫≥ng</label>
                                <label class="filter-item"><input type="checkbox" checked> THU.03.02 - Kh√°c</label>
                                <label class="filter-item"><input type="checkbox" checked> THU.04.01 - Doanh thu kh√°c 1</label>
                                <label class="filter-item"><input type="checkbox" checked> THU.04.02 - Doanh thu kh√°c 2</label>
                                <label class="filter-item"><input type="checkbox" checked> CHI.01.10 - H·ªì s∆° ph√°p l√Ω d·ª± √°n</label>
                                <label class="filter-item"><input type="checkbox" checked> CHI.01.20 - Ph√≠ gi·∫•y ph√©p x√¢y d·ª±ng</label>
                                <label class="filter-item"><input type="checkbox" checked> CHI.01.30 - T∆∞ v·∫•n ph√°p l√Ω & h·ª£p ƒë·ªìng</label>
                                <label class="filter-item"><input type="checkbox" checked> CHI.01.40 - L·ªá ph√≠ th·∫©m ƒë·ªãnh</label>
                                <label class="filter-item"><input type="checkbox" checked> CHI.02.10 - Kh·∫£o s√°t ƒë·ªãa h√¨nh</label>
                                <label class="filter-item"><input type="checkbox" checked> CHI.02.20 - Thi·∫øt k·∫ø c∆° s·ªü</label>
                                <label class="filter-item"><input type="checkbox" checked> CHI.02.30 - Thi·∫øt k·∫ø k·ªπ thu·∫≠t</label>
                                <label class="filter-item"><input type="checkbox" checked> CHI.02.40 - Th·∫©m tra thi·∫øt k·∫ø</label>
                                <label class="filter-item"><input type="checkbox" checked> CHI.03.10 - Marketing & truy·ªÅn th√¥ng</label>
                                <label class="filter-item"><input type="checkbox" checked> CHI.03.20 - S√†n giao d·ªãch & m√¥i gi·ªõi</label>
                                <label class="filter-item"><input type="checkbox" checked> CHI.03.30 - ChƒÉm s√≥c kh√°ch h√†ng</label>
                                <label class="filter-item"><input type="checkbox" checked> CHI.03.40 - Chi ph√≠ s·ª± ki·ªán b√°n h√†ng</label>
                                <label class="filter-item"><input type="checkbox" checked> CHI.04.00 - Chi ph√≠ b·∫£o l√£nh, b·∫£o hi·ªÉm</label>
                                <label class="filter-item"><input type="checkbox" checked> CHI.04.20 - An to√†n lao ƒë·ªông & VSMT</label>
                                <label class="filter-item"><input type="checkbox" checked> CHI.04.30 - An ninh cho c√¥ng tr∆∞·ªùng</label>
                                <label class="filter-item"><input type="checkbox" checked> CHI.04.40 - Tr·∫Øc ƒë·∫°c c√¥ng tr√¨nh</label>
                                <label class="filter-item"><input type="checkbox" checked> CHI.05.10 - Thi·∫øt b·ªã thi c√¥ng ch√≠nh</label>
                                <label class="filter-item"><input type="checkbox" checked> CHI.05.20 - Thi·∫øt b·ªã ph·ª• tr·ª£</label>
                                <label class="filter-item"><input type="checkbox" checked> CHI.05.30 - L·∫Øp ƒë·∫∑t & hi·ªáu ch·ªânh</label>
                                <label class="filter-item"><input type="checkbox" checked> CHI.05.40 - B·∫£o tr√¨ thi·∫øt b·ªã</label>
                                <label class="filter-item"><input type="checkbox" checked> CHI.06.10 - Nh√¢n c√¥ng tr·ª±c ti·∫øp</label>
                                <label class="filter-item"><input type="checkbox" checked> CHI.06.20 - Th·∫ßu ph·ª• k·∫øt c·∫•u</label>
                                <label class="filter-item"><input type="checkbox" checked> CHI.06.30 - Th·∫ßu ph·ª• ho√†n thi·ªán</label>
                                <label class="filter-item"><input type="checkbox" checked> CHI.06.40 - An to√†n & b·∫£o h·ªô lao ƒë·ªông</label>
                                <label class="filter-item"><input type="checkbox" checked> CHI.07.10 - V·∫≠t t∆∞ ch√≠nh</label>
                                <label class="filter-item"><input type="checkbox" checked> CHI.07.20 - V·∫≠t t∆∞ ph·ª•</label>
                                <label class="filter-item"><input type="checkbox" checked> CHI.07.30 - V·∫≠n chuy·ªÉn & b·ªëc d·ª°</label>
                                <label class="filter-item"><input type="checkbox" checked> CHI.07.40 - Nh√† cung c·∫•p chi·∫øn l∆∞·ª£c</label>
                                <label class="filter-item"><input type="checkbox" checked> CHI.08.10 - V·∫≠n h√†nh c√¥ng tr∆∞·ªùng</label>
                                <label class="filter-item"><input type="checkbox" checked> CHI.08.20 - Nhi√™n li·ªáu & nƒÉng l∆∞·ª£ng</label>
                                <label class="filter-item"><input type="checkbox" checked> CHI.08.30 - B·∫£o v·ªá & an ninh</label>
                                <label class="filter-item"><input type="checkbox" checked> CHI.08.40 - H·∫≠u c·∫ßn hi·ªán tr∆∞·ªùng</label>
                            </div>
                        </div>
                    </div>
                    <div class="kpi-grid page2-approval">
                        <div class="kpi-card">
                            <div class="kpi-label">T·ªïng thu sau duy·ªát</div>
                            <div class="kpi-value-row">
                                <div class="kpi-value" id="p2AfterRevenue">0</div>
                                <div class="kpi-side">
                                    <div class="kpi-sub">Tr∆∞·ªõc: <span id="p2BeforeRevenue">0.0 T·ª∑</span></div>
                                    <div class="kpi-sub kpi-delta" id="p2DeltaRevenue">Œî 0.0 T·ª∑</div>
                                </div>
                            </div>
                        </div>
                        <div class="kpi-card">
                            <div class="kpi-label">T·ªïng chi sau duy·ªát</div>
                            <div class="kpi-value-row">
                                <div class="kpi-value" id="p2AfterCost">0</div>
                                <div class="kpi-side">
                                    <div class="kpi-sub">Tr∆∞·ªõc: <span id="p2BeforeCost">0.0 T·ª∑</span></div>
                                    <div class="kpi-sub kpi-delta" id="p2DeltaCost">Œî 0.0 T·ª∑</div>
                                </div>
                            </div>
                        </div>
                        <div class="kpi-card">
                            <div class="kpi-label">Ng√¢n s√°ch sau duy·ªát (Net)</div>
                            <div class="kpi-value-row">
                                <div class="kpi-value" id="p2AfterNet">0</div>
                                <div class="kpi-side">
                                    <div class="kpi-sub">Tr∆∞·ªõc: <span id="p2BeforeNet">0.0 T·ª∑</span></div>
                                    <div class="kpi-sub kpi-delta" id="p2DeltaNet">Œî 0.0 T·ª∑</div>
                                </div>
                            </div>
                        </div>
                        <div class="kpi-card">
                            <div class="kpi-label">FHI sau duy·ªát</div>
                            <div class="kpi-value-row">
                                <div class="kpi-value" id="p2AfterFhi">0</div>
                                <div class="kpi-side">
                                    <div class="kpi-sub">Tr∆∞·ªõc: <span id="p2BeforeFhi">0.00</span></div>
                                    <div class="kpi-sub kpi-delta" id="p2DeltaFhi">Œî 0.00</div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div id="page3" class="page">
                <div class="page-header">
                    <h1 class="page-title">T√¨nh H√¨nh Thu Th·ª±c T·∫ø</h1>
                    <p class="page-subtitle">Ph√¢n t√≠ch chi ti·∫øt doanh thu theo danh m·ª•c v√† kho·∫£n m·ª•c chi ti·∫øt</p>
                </div>

                <div class="page3-content">
                    <div class="chart-grid">
                        <div class="chart-card" style="position: relative;">
                            <div class="chart-title">üéØ T·ªïng Doanh Thu So V·ªõi K·∫ø Ho·∫°ch</div>
                            <div class="chart-container small" style="display: flex; align-items: center; justify-content: center; padding: 12px;">
                                <canvas id="chart6" width="420" height="200" style="width:100%; height:auto; max-width:420px;"></canvas>
                            </div>
                        </div>
                        <div class="chart-card"><div class="chart-title">üìä Doanh Thu: K·∫ø Ho·∫°ch vs Th·ª±c T·∫ø</div><div class="chart-container"><canvas id="chart7"></canvas></div></div>
                        <div class="chart-card"><div class="chart-title">üìà Doanh Thu Th·ª±c T·∫ø vs NƒÉm Ngo√°i</div><div class="chart-container"><canvas id="chart8"></canvas></div></div>
                    </div>

                    <div class="chart-grid page3-two" style="padding: 20px 0;">
                        <div class="stacked-col">
                            <div class="chart-card"><div class="chart-title">üíº THU.01 - Thu t·ª´ Ch·ªß ƒê·∫ßu T∆∞ (Chi ti·∫øt 3 kho·∫£n ch√≠nh)</div><div class="chart-container tall"><canvas id="chart8b"></canvas></div></div>
                            <div class="chart-card"><div class="chart-title">üìä Th·ª±c T·∫ø vs K·∫ø Ho·∫°ch</div><div class="chart-container tall"><canvas id="chart8c"></canvas></div></div>
                        </div>
                        <div class="table-col">
                            <div class="chart-card"><div class="chart-title">üìã Chi Ti·∫øt Doanh Thu Theo H·∫°ng M·ª•c - 12 Th√°ng</div><div style="overflow-x: auto; max-height: 650px;"><table class="matrix-table"><thead><tr><th>Danh M·ª•c & H·∫°ng M·ª•c</th><th>T1</th><th>T2</th><th>T3</th><th>T4</th><th>T5</th><th>T6</th><th>T7</th><th>T8</th><th>T9</th><th>T10</th><th>T11</th><th>T12</th><th>T·ªïng</th><th>%</th></tr></thead><tbody><tr style="background: #fff3cd; font-weight: bold;"><td>THU.01 - Thu t·ª´ CDT</td><td>7.2</td><td>7.5</td><td>7.8</td><td>8.1</td><td>8.4</td><td>8.7</td><td>9.0</td><td>9.3</td><td>9.6</td><td>9.9</td><td>10.2</td><td>10.5</td><td>105.2</td><td>72.7%</td></tr><tr><td style="padding-left: 30px;">THU.01.01 - T∆∞ v·∫•n</td><td>3.2</td><td>3.3</td><td>3.5</td><td>3.6</td><td>3.8</td><td>3.9</td><td>4.1</td><td>4.2</td><td>4.4</td><td>4.5</td><td>4.7</td><td>4.8</td><td>47.0</td><td>32.5%</td></tr><tr><td style="padding-left: 30px;">THU.01.02 - Rao s·ª±</td><td>2.5</td><td>2.6</td><td>2.7</td><td>2.8</td><td>2.9</td><td>3.0</td><td>3.1</td><td>3.2</td><td>3.3</td><td>3.4</td><td>3.5</td><td>3.6</td><td>36.6</td><td>25.3%</td></tr><tr><td style="padding-left: 30px;">THU.01.03 - B·∫£n quy·ªÅn & Kh√°c</td><td>1.5</td><td>1.6</td><td>1.6</td><td>1.7</td><td>1.7</td><td>1.8</td><td>1.8</td><td>1.9</td><td>1.9</td><td>2.0</td><td>2.0</td><td>2.1</td><td>21.6</td><td>14.9%</td></tr><tr style="background: #e3f2fd; font-weight: bold;"><td>THU.02 - Thu Ho·∫°t ƒê·ªông T√†i Ch√≠nh</td><td>1.5</td><td>1.6</td><td>1.6</td><td>1.7</td><td>1.7</td><td>1.8</td><td>1.8</td><td>1.9</td><td>1.9</td><td>2.0</td><td>2.0</td><td>2.1</td><td>21.6</td><td>14.9%</td></tr><tr><td style="padding-left: 30px;">THU.02.01 - L√£i su·∫•t ng√¢n h√†ng</td><td>0.9</td><td>0.9</td><td>0.9</td><td>1.0</td><td>1.0</td><td>1.0</td><td>1.1</td><td>1.1</td><td>1.1</td><td>1.2</td><td>1.2</td><td>1.2</td><td>12.6</td><td>8.7%</td></tr><tr><td style="padding-left: 30px;">THU.02.02 - C·ªï t·ª©c & Kh√°c</td><td>0.6</td><td>0.7</td><td>0.7</td><td>0.7</td><td>0.7</td><td>0.8</td><td>0.7</td><td>0.8</td><td>0.8</td><td>0.8</td><td>0.8</td><td>0.9</td><td>9.0</td><td>6.2%</td></tr><tr style="background: #f0f4f8; font-weight: bold;"><td>THU.03 - Thu t·ª´ Ngu·ªìn Kh√°c</td><td>1.2</td><td>1.2</td><td>1.2</td><td>1.3</td><td>1.3</td><td>1.4</td><td>1.4</td><td>1.4</td><td>1.5</td><td>1.5</td><td>1.5</td><td>1.6</td><td>16.5</td><td>11.4%</td></tr><tr><td style="padding-left: 30px;">THU.03.01 - B·∫£o t√≠n v·ªá th·∫≥ng</td><td>0.7</td><td>0.7</td><td>0.7</td><td>0.8</td><td>0.8</td><td>0.8</td><td>0.8</td><td>0.9</td><td>0.9</td><td>0.9</td><td>0.9</td><td>1.0</td><td>10.1</td><td>7.0%</td></tr><tr><td style="padding-left: 30px;">THU.03.02 - Kh√°c</td><td>0.5</td><td>0.5</td><td>0.5</td><td>0.5</td><td>0.5</td><td>0.6</td><td>0.6</td><td>0.5</td><td>0.6</td><td>0.6</td><td>0.6</td><td>0.6</td><td>6.4</td><td>4.4%</td></tr><tr style="background: #fce4ec; font-weight: bold;"><td>THU.04 - Thu Kh√°c</td><td>0.5</td><td>0.5</td><td>0.5</td><td>0.5</td><td>0.6</td><td>0.6</td><td>0.6</td><td>0.6</td><td>0.7</td><td>0.7</td><td>0.7</td><td>0.8</td><td>7.3</td><td>5.0%</td></tr><tr><td style="padding-left: 30px;">THU.04.01 - Doanh thu kh√°c 1</td><td>0.3</td><td>0.3</td><td>0.3</td><td>0.3</td><td>0.3</td><td>0.3</td><td>0.3</td><td>0.3</td><td>0.4</td><td>0.4</td><td>0.4</td><td>0.4</td><td>4.2</td><td>2.9%</td></tr><tr><td style="padding-left: 30px;">THU.04.02 - Doanh thu kh√°c 2</td><td>0.2</td><td>0.2</td><td>0.2</td><td>0.2</td><td>0.3</td><td>0.3</td><td>0.3</td><td>0.3</td><td>0.3</td><td>0.3</td><td>0.3</td><td>0.4</td><td>3.1</td><td>2.1%</td></tr><tr style="background: var(--primary-light); font-weight: bold;"><td>T·ªîNG DOANH THU</td><td>10.4</td><td>10.8</td><td>11.1</td><td>11.6</td><td>12.0</td><td>12.5</td><td>12.8</td><td>13.2</td><td>13.7</td><td>14.1</td><td>14.6</td><td>15.0</td><td>150.8</td><td>100%</td></tr></tbody></table></div></div>
                        </div>
                    </div>
                </div>

                <div class="kpi-grid page3-kpis">
                    <div class="kpi-card"><div class="kpi-label">T·ªïng thu ng√¢n s√°ch</div><div class="kpi-value">560.0 T·ª∑</div><div class="kpi-change positive">K·∫ø ho·∫°ch</div></div>
                    <div class="kpi-card"><div class="kpi-label">T·ªïng th·ª±c thu</div><div class="kpi-value">545.0 T·ª∑</div><div class="kpi-change negative">-2.7%</div></div>
                    <div class="kpi-card"><div class="kpi-label">% ƒë·∫°t k·∫ø ho·∫°ch</div><div class="kpi-value">97.3%</div><div class="kpi-change positive">·ªîn ƒë·ªãnh</div></div>
                    <div class="kpi-card"><div class="kpi-label">D·ª± √°n kh√¥ng ƒë·∫°t</div><div class="kpi-value">2 d·ª± √°n</div><div class="kpi-change negative">C·∫ßn theo d√µi</div></div>
                </div>

                <div class="chart-grid single">
                    <div class="chart-card"><div class="chart-title">Xu h∆∞·ªõng thu: Ng√¢n s√°ch vs Th·ª±c thu</div><div class="chart-container"><canvas id="chartP3Trend"></canvas></div></div>
                </div>

                <div class="chart-grid two">
                    <div class="chart-card"><div class="chart-title">Thu ng√¢n s√°ch vs Th·ª±c thu theo d·ª± √°n</div><div class="chart-container"><canvas id="chartP3ByProject"></canvas></div></div>
                    <div class="chart-card"><div class="chart-title">Ch√™nh l·ªách thu theo d·ª± √°n</div><div class="chart-container"><canvas id="chartP3Variance"></canvas></div></div>
                </div>

                <div class="chart-card">
                    <div class="chart-title">B·∫£ng chi ti·∫øt thu theo d·ª± √°n</div>
                    <div style="overflow-x: auto; max-height: 360px;">
                        <table class="matrix-table">
                            <thead>
                                <tr>
                                    <th>D·ª± √°n</th>
                                    <th>Thu ng√¢n s√°ch</th>
                                    <th>Th·ª±c thu</th>
                                    <th>% ƒë·∫°t</th>
                                    <th>Xu h∆∞·ªõng</th>
                                </tr>
                            </thead>
                            <tbody id="p3DetailBody"></tbody>
                        </table>
                    </div>
                </div>
            </div>

            <div id="page4" class="page">
                <div class="page-header">
                    <h1 class="page-title">T√¨nh H√¨nh Chi Th·ª±c T·∫ø</h1>
                    <p class="page-subtitle">Ki·ªÉm so√°t chi ti√™u so v·ªõi ng√¢n s√°ch</p>
                </div>

                <div class="page4-content">
                    <div class="kpi-grid">
                        <div class="kpi-card"><div class="kpi-label">Ng√¢n S√°ch</div><div class="kpi-value">142.3 T·ª∑</div><div class="kpi-change positive">Hi·ªán t·∫°i</div></div>
                        <div class="kpi-card"><div class="kpi-label">ƒê√£ Chi</div><div class="kpi-value">87.4 T·ª∑</div><div class="kpi-change negative">61.4%</div></div>
                        <div class="kpi-card"><div class="kpi-label">C√≤n L·∫°i</div><div class="kpi-value">54.9 T·ª∑</div><div class="kpi-change positive">38.6%</div></div>
                        <div class="kpi-card"><div class="kpi-label">M·ª©c V∆∞·ª£t K·∫ø Ho·∫°ch</div><div class="kpi-value">12-15%</div><div class="kpi-change negative">Nguy hi·ªÉm</div></div>
                    </div>

                    <div class="chart-grid">
                        <div class="chart-card" style="position: relative;">
                            <div class="chart-title">üéØ T·ªïng ƒê√£ Chi So V·ªõi K·∫ø Ho·∫°ch Chi</div>
                            <div class="chart-container gauge" style="display: flex; align-items: center; justify-content: center; padding: 12px;">
                                <canvas id="chart9" width="520" height="260" style="width:100%; height:100%; max-width:none;"></canvas>
                            </div>
                        </div>
                        <div class="chart-card"><div class="chart-title">üìä Chi Th·ª±c T·∫ø vs K·∫ø Ho·∫°ch Theo Th√°ng</div><div class="chart-container"><canvas id="chart11c"></canvas></div></div>
                        <div class="chart-card"><div class="chart-title">üìà L≈©y K·∫ø Chi: NƒÉm Nay vs NƒÉm Tr∆∞·ªõc</div><div class="chart-container"><canvas id="chart11d"></canvas></div></div>
                    </div>

                    <div class="chart-grid page3-two page4-two" style="padding: 20px 0;">
                        <div class="stacked-col">
                            <div class="chart-card"><div class="chart-title">üéØ T·ªïng ƒê√£ Chi So V·ªõi K·∫ø Ho·∫°ch Chi</div><div class="chart-container small"><canvas id="chart9_old" width="420" height="200" style="width:100%; height:auto; max-width:420px;"></canvas></div></div>
                            <div class="chart-card"><div class="chart-title">ü•ß Ph√¢n B·ªï Chi Theo Danh M·ª•c</div><div class="chart-container tall"><canvas id="chart10"></canvas></div></div>
                            <div class="chart-card"><div class="chart-title">üìä Th·ª±c T·∫ø vs K·∫ø Ho·∫°ch - C√°c M·ª•c Chi</div><div class="chart-container tall"><canvas id="chart11"></canvas></div></div>
                        </div>
                        <div class="table-col">
                            <div class="chart-card">
                                <div class="chart-title">üìã Chi Ti·∫øt Chi Theo H·∫°ng M·ª•c - 12 Th√°ng</div>
                                <div style="overflow-x: auto; max-height: 650px;">
                                    <table class="matrix-table">
                                        <thead>
                                            <tr>
                                                <th>H·∫°ng M·ª•c Chi</th>
                                                <th>T1</th>
                                                <th>T2</th>
                                                <th>T3</th>
                                                <th>T4</th>
                                                <th>T5</th>
                                                <th>T6</th>
                                                <th>T7</th>
                                                <th>T8</th>
                                                <th>T9</th>
                                                <th>T10</th>
                                                <th>T11</th>
                                                <th>T12</th>
                                                <th>T·ªïng</th>
                                            </tr>
                                        </thead>
                                        <tbody>
                                            <tr style="background: #fff3cd; font-weight: bold;"><td>CHI.01 - Chi cho ph√°p l√Ω d·ª± √°n</td><td>0.5</td><td>0.5</td><td>0.6</td><td>0.6</td><td>0.5</td><td>0.5</td><td>0.5</td><td>0.6</td><td>0.5</td><td>0.5</td><td>0.6</td><td>0.5</td><td>6.4</td></tr>
                                            <tr style="background: #fff3cd; font-weight: bold;"><td>CHI.02 - Chi cho ki·∫øn thi·∫øt c∆° b·∫£n</td><td>1.1</td><td>1.2</td><td>1.2</td><td>1.3</td><td>1.3</td><td>1.4</td><td>1.4</td><td>1.3</td><td>1.2</td><td>1.2</td><td>1.1</td><td>1.1</td><td>14.8</td></tr>
                                            <tr style="background: #fff3cd; font-weight: bold;"><td>CHI.03 - Chi cho c√¥ng t√°c b√°n h√†ng</td><td>0.8</td><td>0.9</td><td>0.9</td><td>1.0</td><td>0.9</td><td>0.9</td><td>0.9</td><td>0.8</td><td>0.8</td><td>0.8</td><td>0.8</td><td>0.8</td><td>10.3</td></tr>
                                            <tr style="background: #fff3cd; font-weight: bold;"><td>CHI.04 - Chi c√¥ng t√°c chu·∫©n b·ªã</td><td>0.6</td><td>0.6</td><td>0.7</td><td>0.7</td><td>0.7</td><td>0.7</td><td>0.7</td><td>0.7</td><td>0.6</td><td>0.6</td><td>0.6</td><td>0.6</td><td>7.8</td></tr>
                                            <tr style="background: #fff3cd; font-weight: bold;"><td>CHI.05 - Chi c√¥ng t√°c thi·∫øt b·ªã</td><td>0.9</td><td>1.0</td><td>1.0</td><td>1.1</td><td>1.1</td><td>1.1</td><td>1.1</td><td>1.0</td><td>1.0</td><td>0.9</td><td>0.9</td><td>0.9</td><td>12.0</td></tr>
                                            <tr style="background: #fff3cd; font-weight: bold;"><td>CHI.06 - Chi nh√¢n c√¥ng & th·∫ßu ph·ª•</td><td>2.0</td><td>2.1</td><td>2.3</td><td>2.4</td><td>2.5</td><td>2.6</td><td>2.6</td><td>2.5</td><td>2.4</td><td>2.3</td><td>2.2</td><td>2.2</td><td>28.1</td></tr>
                                            <tr><td style="padding-left: 30px;">CHI.06.30.31 - G√≥i th·∫ßu k·∫øt c·∫•u A</td><td>0.2</td><td>0.2</td><td>0.2</td><td>0.2</td><td>0.2</td><td>0.2</td><td>0.2</td><td>0.2</td><td>0.2</td><td>0.2</td><td>0.2</td><td>0.2</td><td>2.4</td></tr>
                                            <tr><td style="padding-left: 30px;">CHI.06.30.32 - G√≥i th·∫ßu k·∫øt c·∫•u B</td><td>0.2</td><td>0.2</td><td>0.2</td><td>0.2</td><td>0.2</td><td>0.2</td><td>0.2</td><td>0.2</td><td>0.2</td><td>0.2</td><td>0.2</td><td>0.2</td><td>2.4</td></tr>
                                            <tr><td style="padding-left: 30px;">CHI.06.30.33 - G√≥i th·∫ßu k·∫øt c·∫•u C</td><td>0.2</td><td>0.2</td><td>0.2</td><td>0.2</td><td>0.2</td><td>0.2</td><td>0.2</td><td>0.2</td><td>0.2</td><td>0.2</td><td>0.2</td><td>0.2</td><td>2.4</td></tr>
                                            <tr><td style="padding-left: 30px;">CHI.06.30.34 - G√≥i th·∫ßu k·∫øt c·∫•u D</td><td>0.2</td><td>0.2</td><td>0.2</td><td>0.2</td><td>0.2</td><td>0.2</td><td>0.2</td><td>0.2</td><td>0.2</td><td>0.2</td><td>0.2</td><td>0.2</td><td>2.4</td></tr>
                                            <tr><td style="padding-left: 30px;">CHI.06.40.41 - G√≥i th·∫ßu ho√†n thi·ªán A</td><td>0.2</td><td>0.2</td><td>0.2</td><td>0.2</td><td>0.2</td><td>0.2</td><td>0.2</td><td>0.2</td><td>0.2</td><td>0.2</td><td>0.2</td><td>0.2</td><td>2.4</td></tr>
                                            <tr><td style="padding-left: 30px;">CHI.06.40.06 - G√≥i th·∫ßu A</td><td>0.2</td><td>0.2</td><td>0.2</td><td>0.2</td><td>0.2</td><td>0.2</td><td>0.2</td><td>0.2</td><td>0.2</td><td>0.2</td><td>0.2</td><td>0.2</td><td>2.4</td></tr>
                                            <tr><td style="padding-left: 30px;">CHI.06.40.07 - G√≥i th·∫ßu B</td><td>0.2</td><td>0.2</td><td>0.2</td><td>0.2</td><td>0.2</td><td>0.2</td><td>0.2</td><td>0.2</td><td>0.2</td><td>0.2</td><td>0.2</td><td>0.2</td><td>2.4</td></tr>
                                            <tr><td style="padding-left: 30px;">CHI.06.40.08 - G√≥i th·∫ßu C</td><td>0.2</td><td>0.2</td><td>0.2</td><td>0.2</td><td>0.2</td><td>0.2</td><td>0.2</td><td>0.2</td><td>0.2</td><td>0.2</td><td>0.2</td><td>0.2</td><td>2.4</td></tr>
                                            <tr><td style="padding-left: 30px;">CHI.06.40.15 - G√≥i th·∫ßu D</td><td>0.2</td><td>0.2</td><td>0.2</td><td>0.2</td><td>0.2</td><td>0.2</td><td>0.2</td><td>0.2</td><td>0.2</td><td>0.2</td><td>0.2</td><td>0.2</td><td>2.4</td></tr>
                                            <tr><td style="padding-left: 30px;">CHI.06.50.13 - G√≥i th·∫ßu E</td><td>0.2</td><td>0.2</td><td>0.2</td><td>0.2</td><td>0.2</td><td>0.2</td><td>0.2</td><td>0.2</td><td>0.2</td><td>0.2</td><td>0.2</td><td>0.2</td><td>2.4</td></tr>
                                            <tr><td style="padding-left: 30px;">CHI.06.60.01 - G√≥i th·∫ßu F</td><td>0.2</td><td>0.2</td><td>0.2</td><td>0.2</td><td>0.2</td><td>0.2</td><td>0.2</td><td>0.2</td><td>0.2</td><td>0.2</td><td>0.2</td><td>0.2</td><td>2.4</td></tr>
                                            <tr style="background: #fff3cd; font-weight: bold;"><td>CHI.07 - Chi v·∫≠t t∆∞ & NCC</td><td>1.2</td><td>1.3</td><td>1.3</td><td>1.4</td><td>1.4</td><td>1.5</td><td>1.5</td><td>1.4</td><td>1.4</td><td>1.3</td><td>1.2</td><td>1.1</td><td>16.0</td></tr>
                                            <tr style="background: #fff3cd; font-weight: bold;"><td>CHI.08 - Chi cho ho·∫°t ƒë·ªông tr·ª±c ti·∫øp</td><td>0.7</td><td>0.7</td><td>0.8</td><td>0.8</td><td>0.8</td><td>0.8</td><td>0.8</td><td>0.7</td><td>0.7</td><td>0.6</td><td>0.6</td><td>0.5</td><td>8.5</td></tr>
                                            <tr style="background: var(--primary-light); font-weight: bold;"><td>T·ªîNG CHI</td><td>7.8</td><td>8.3</td><td>8.8</td><td>9.3</td><td>9.2</td><td>9.5</td><td>9.5</td><td>9.0</td><td>8.6</td><td>8.2</td><td>8.0</td><td>7.7</td><td>103.9</td></tr>
                                        </tbody>
                                    </table>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="kpi-grid page4-kpis">
                    <div class="kpi-card"><div class="kpi-label">T·ªïng chi ng√¢n s√°ch</div><div class="kpi-value">390.0 T·ª∑</div><div class="kpi-change positive">K·∫ø ho·∫°ch</div></div>
                    <div class="kpi-card"><div class="kpi-label">T·ªïng th·ª±c chi</div><div class="kpi-value">382.0 T·ª∑</div><div class="kpi-change positive">-2.1%</div></div>
                    <div class="kpi-card"><div class="kpi-label">% v∆∞·ª£t ng√¢n s√°ch</div><div class="kpi-value">-2.1%</div><div class="kpi-change positive">Trong ki·ªÉm so√°t</div></div>
                    <div class="kpi-card"><div class="kpi-label">D·ª± √°n v∆∞·ª£t chi</div><div class="kpi-value">1 d·ª± √°n</div><div class="kpi-change negative">C·∫£nh b√°o</div></div>
                </div>

                <div class="chart-grid single">
                    <div class="chart-card"><div class="chart-title">Xu h∆∞·ªõng chi: Ng√¢n s√°ch vs Th·ª±c chi</div><div class="chart-container"><canvas id="chartP4Trend"></canvas></div></div>
                </div>

                <div class="chart-grid two">
                    <div class="chart-card"><div class="chart-title">Chi ng√¢n s√°ch vs Th·ª±c chi theo d·ª± √°n</div><div class="chart-container"><canvas id="chartP4ByProject"></canvas></div></div>
                    <div class="chart-card"><div class="chart-title">Ch√™nh l·ªách chi theo d·ª± √°n</div><div class="chart-container"><canvas id="chartP4Variance"></canvas></div></div>
                </div>

                <div class="chart-grid single">
                    <div class="chart-card"><div class="chart-title">C∆° c·∫•u chi theo h·∫°ng m·ª•c</div><div class="chart-container"><canvas id="chartP4Structure"></canvas></div></div>
                </div>

                <div class="chart-card">
                    <div class="chart-title">B·∫£ng chi ti·∫øt chi theo d·ª± √°n</div>
                    <div style="overflow-x: auto; max-height: 360px;">
                        <table class="matrix-table">
                            <thead>
                                <tr>
                                    <th>D·ª± √°n</th>
                                    <th>Chi ng√¢n s√°ch</th>
                                    <th>Th·ª±c chi</th>
                                    <th>Ch√™nh l·ªách</th>
                                    <th>R·ªßi ro</th>
                                </tr>
                            </thead>
                            <tbody id="p4DetailBody"></tbody>
                        </table>
                    </div>
                </div>
            </div>
        </main>
    </div>

    <script>
        Chart.defaults.font.family = "'Be Vietnam Pro', 'Segoe UI', Tahoma, Arial, sans-serif";

        const chartConfig = {
            responsive: true,
            maintainAspectRatio: false,
            plugins: {
                legend: { labels: { font: { size: 10 }, color: '#6B7280', usePointStyle: true }, position: 'bottom' },
                tooltip: { backgroundColor: 'rgba(0,0,0,0.8)', padding: 10, titleFont: { size: 11 }, bodyFont: { size: 10 }, cornerRadius: 6 }
            }
        };

        const colors = {
            primary: '#DC2626',
            secondary: '#EF4444',
            accent: '#F87171',
            light: '#FCA5A5',
            success: '#10B981',
            warning: '#F59E0B',
            info: '#3B82F6',
            gray: '#9CA3AF'
        };

        const projects = ['DA Alpha', 'DA Beta', 'DA Gamma', 'DA Delta', 'DA Epsilon'];

        const p1RevenueTotal = [120, 110, 105, 135, 95];
        const p1CostTotal = [80, 75, 70, 90, 65];
        const p1RevenueDetail = [...p1RevenueTotal];
        const p1CostDetail = [...p1CostTotal];
        const p1ActualRevenue = [115, 106, 98, 128, 90];
        const p1ActualCost = [78, 70, 66, 89, 60];
        const p1RevenueRatio = p1ActualRevenue.map((v, i) => (v / p1RevenueTotal[i]) * 100);
        const p1CostRatio = p1ActualCost.map((v, i) => (v / p1CostTotal[i]) * 100);

        new Chart(document.getElementById('chartP1Revenue'), {
            type: 'bar',
            data: {
                labels: projects,
                datasets: [
                    { label: 'Ng√¢n s√°ch t·ªïng - Thu', data: p1RevenueTotal, backgroundColor: '#10B981' },
                    { label: 'Ng√¢n s√°ch chi ti·∫øt - Thu', data: p1RevenueDetail, backgroundColor: '#6EE7B7' }
                ]
            },
            options: { ...chartConfig, scales: { y: { beginAtZero: true, ticks: { color: colors.gray }, grid: { color: '#F3F4F6' } }, x: { ticks: { color: colors.gray } } } }
        });

        new Chart(document.getElementById('chartP1Cost'), {
            type: 'bar',
            data: {
                labels: projects,
                datasets: [
                    { label: 'Ng√¢n s√°ch t·ªïng - Chi', data: p1CostTotal, backgroundColor: colors.primary },
                    { label: 'Ng√¢n s√°ch chi ti·∫øt - Chi', data: p1CostDetail, backgroundColor: colors.light }
                ]
            },
            options: { ...chartConfig, scales: { y: { beginAtZero: true, ticks: { color: colors.gray }, grid: { color: '#F3F4F6' } }, x: { ticks: { color: colors.gray } } } }
        });

        new Chart(document.getElementById('chartP1RevenueActual'), {
            data: {
                labels: projects,
                datasets: [
                            {
                                type: 'bar',
                                label: 'Thu th·ª±c t·∫ø (T·ª∑)',
                                data: p1ActualRevenue,
                                backgroundColor: '#10B981',
                                order: 10
                            },
                            {
                                type: 'bar',
                                label: 'Ng√¢n s√°ch t·ªïng - Thu',
                                data: p1RevenueTotal,
                                backgroundColor: '#93C5FD',
                                order: 10
                            },
                            {
                                type: 'line',
                                label: 'T·ª∑ l·ªá ƒë·∫°t (%)',
                                data: p1RevenueRatio,
                                borderColor: '#F59E0B',
                                borderWidth: 3.2,
                                pointRadius: 4,
                                pointHoverRadius: 6,
                                pointBackgroundColor: '#F59E0B',
                                pointBorderColor: '#FFFFFF',
                                pointBorderWidth: 2,
                                tension: 0.35,
                                fill: false,
                                yAxisID: 'yRatio',
                                order: 1   // üëà PH·∫¢I NH·ªé NH·∫§T
                            }
                        ]

            },
            options: {
                ...chartConfig,
                scales: {
                    y: { beginAtZero: true, ticks: { color: colors.gray }, grid: { color: '#F3F4F6' } },
                    yRatio: {
                        position: 'right',
                            min: 0,          // üëà B·∫ÆT BU·ªòC
                            max: 100,        // üëà B·∫ÆT BU·ªòC
                        ticks: { color: colors.gray, callback: (value) => value + '%' },
                        grid: { drawOnChartArea: false },
                        suggestedMax: 130
                    },
                    x: { ticks: { color: colors.gray } }
                }
            }
        });

        new Chart(document.getElementById('chartP1CostActual'), {
            data: {
                labels: projects,
                datasets: [
            {
                type: 'bar',
                label: 'Chi th·ª±c t·∫ø (T·ª∑)',
                data: p1ActualCost,
                backgroundColor: colors.primary,
                order: 10
            },
            {
                type: 'bar',
                label: 'Ng√¢n s√°ch t·ªïng - Chi',
                data: p1CostTotal,
                backgroundColor: colors.light,
                order: 10
            },
            {
                type: 'line',
                label: 'T·ª∑ l·ªá s·ª≠ d·ª•ng (%)',
                data: p1CostRatio,
                borderColor: '#F59E0B',
                borderWidth: 3.2,
                pointRadius: 4,
                pointHoverRadius: 6,
                pointBackgroundColor: '#F59E0B',
                pointBorderColor: '#FFFFFF',
                pointBorderWidth: 2,
                tension: 0.35,
                fill: false,
                yAxisID: 'yRatio',
                order: 1   // üëà LINE V·∫º SAU ‚Üí N·∫∞M TR√äN
            }        
            ]
            },
            options: {
                ...chartConfig,
                scales: {
                    y: { beginAtZero: true, ticks: { color: colors.gray }, grid: { color: '#F3F4F6' } },
                    yRatio: {
                        position: 'right',
                            min: 0,          // üëà B·∫ÆT BU·ªòC
                            max: 100,        // üëà B·∫ÆT BU·ªòC
                        ticks: { color: colors.gray, callback: (value) => value + '%' },
                        grid: { drawOnChartArea: false },
                        suggestedMax: 130
                    },
                    x: { ticks: { color: colors.gray } }
                }
            }
        });

        const budgetCompare = {
            total: {
                revenue: { ver0: 520, latest: 560 },
                cost: { ver0: 360, latest: 390 },
                approvalVersion: 'Ver Latest',
                table: [

                    { item: 'THU.01 - Thu t·ª´ Ch·ªß ƒê·∫ßu T∆∞', ver0: 250, latest: 270, version: 'V1' },
                    { item: 'THU.02 - Thu Ho·∫°t ƒê·ªông T√†i Ch√≠nh', ver0: 120, latest: 130, version: 'V1' },
                    { item: 'THU.03 - Thu t·ª´ Ngu·ªìn Kh√°c', ver0: 90, latest: 95, version: 'V2' },
                    { item: 'THU.04 - Thu Kh√°c', ver0: 60, latest: 65, version: 'V2' },
                    { item: 'CHI.01 - Chi cho ph√°p l√Ω d·ª± √°n', ver0: 35, latest: 40, version: 'V1' },
                    { item: 'CHI.02 - Chi cho ki·∫øn thi·∫øt c∆° b·∫£n', ver0: 110, latest: 120, version: 'V2' },
                    { item: 'CHI.03 - Chi cho c√¥ng t√°c b√°n h√†ng', ver0: 55, latest: 60, version: 'V2' },
                    { item: 'CHI.04 - Chi c√¥ng t√°c chu·∫©n b·ªã', ver0: 40, latest: 44, version: 'V2' },
                    { item: 'CHI.05 - Chi c√¥ng t√°c thi·∫øt b·ªã', ver0: 45, latest: 50, version: 'V2' },
                    { item: 'CHI.06 - Chi nh√¢n c√¥ng & th·∫ßu ph·ª•', ver0: 50, latest: 55, version: 'V3' },
                    { item: 'CHI.07 - Chi v·∫≠t t∆∞ & NCC', ver0: 15, latest: 16, version: 'V3' },
                    { item: 'CHI.08 - Chi cho ho·∫°t ƒë·ªông tr·ª±c ti·∫øp', ver0: 10, latest: 5, version: 'V3' }
                ],
                approval: { revenue: 575, cost: 405, net: 170, fhi: 2.15 }
            },
            detail: {
                revenue: { ver0: 510, latest: 538 },
                cost: { ver0: 350, latest: 375 },
                approvalVersion: 'Ver Latest',
                table: [

                    { item: 'THU.01.01 - T∆∞ v·∫•n', ver0: 95, latest: 102, version: 'V1' },
                    { item: 'THU.01.02 - Rao s·ª±', ver0: 70, latest: 75, version: 'V1' },
                    { item: 'THU.01.03 - B·∫£n quy·ªÅn & Kh√°c', ver0: 60, latest: 64, version: 'V1' },
                    { item: 'THU.02.01 - L√£i su·∫•t ng√¢n h√†ng', ver0: 55, latest: 58, version: 'V2' },
                    { item: 'THU.02.02 - C·ªï t·ª©c & Kh√°c', ver0: 45, latest: 47, version: 'V2' },
                    { item: 'THU.03.01 - B·∫£o t√≠n v·ªá th·∫≥ng', ver0: 35, latest: 38, version: 'V2' },
                    { item: 'THU.03.02 - Kh√°c', ver0: 25, latest: 27, version: 'V2' },
                    { item: 'THU.04.01 - Doanh thu kh√°c 1', ver0: 20, latest: 22, version: 'V2' },
                    { item: 'THU.04.02 - Doanh thu kh√°c 2', ver0: 20, latest: 22, version: 'V2' },
                    { item: 'CHI.01.10 - H·ªì s∆° ph√°p l√Ω d·ª± √°n', ver0: 6.0, latest: 6.5, version: 'V1' },
                    { item: 'CHI.01.20 - Ph√≠ gi·∫•y ph√©p x√¢y d·ª±ng', ver0: 5.5, latest: 6.0, version: 'V1' },
                    { item: 'CHI.01.30 - T∆∞ v·∫•n ph√°p l√Ω & h·ª£p ƒë·ªìng', ver0: 4.8, latest: 5.2, version: 'V1' },
                    { item: 'CHI.01.40 - L·ªá ph√≠ th·∫©m ƒë·ªãnh', ver0: 6.0, latest: 6.4, version: 'V1' },
                    { item: 'CHI.02.10 - Kh·∫£o s√°t ƒë·ªãa h√¨nh', ver0: 8.5, latest: 9.2, version: 'V2' },
                    { item: 'CHI.02.20 - Thi·∫øt k·∫ø c∆° s·ªü', ver0: 9.0, latest: 9.7, version: 'V2' },
                    { item: 'CHI.02.30 - Thi·∫øt k·∫ø k·ªπ thu·∫≠t', ver0: 7.5, latest: 8.1, version: 'V2' },
                    { item: 'CHI.02.40 - Th·∫©m tra thi·∫øt k·∫ø', ver0: 8.0, latest: 8.6, version: 'V2' },
                    { item: 'CHI.03.10 - Marketing & truy·ªÅn th√¥ng', ver0: 5.5, latest: 6.0, version: 'V2' },
                    { item: 'CHI.03.20 - S√†n giao d·ªãch & m√¥i gi·ªõi', ver0: 6.2, latest: 6.8, version: 'V2' },
                    { item: 'CHI.03.30 - ChƒÉm s√≥c kh√°ch h√†ng', ver0: 4.2, latest: 4.6, version: 'V2' },
                    { item: 'CHI.03.40 - Chi ph√≠ s·ª± ki·ªán b√°n h√†ng', ver0: 5.0, latest: 5.4, version: 'V2' },
                    { item: 'CHI.04.00 - Chi ph√≠ b·∫£o l√£nh, b·∫£o hi·ªÉm', ver0: 4.5, latest: 5.0, version: 'V2' },
                    { item: 'CHI.04.20 - An to√†n lao ƒë·ªông & VSMT', ver0: 4.0, latest: 4.4, version: 'V2' },
                    { item: 'CHI.04.30 - An ninh cho c√¥ng tr∆∞·ªùng', ver0: 4.6, latest: 5.1, version: 'V2' },
                    { item: 'CHI.04.40 - Tr·∫Øc ƒë·∫°c c√¥ng tr√¨nh', ver0: 5.2, latest: 5.6, version: 'V2' },
                    { item: 'CHI.05.10 - Thi·∫øt b·ªã thi c√¥ng ch√≠nh', ver0: 6.8, latest: 7.4, version: 'V3' },
                    { item: 'CHI.05.20 - Thi·∫øt b·ªã ph·ª• tr·ª£', ver0: 5.5, latest: 6.0, version: 'V3' },
                    { item: 'CHI.05.30 - L·∫Øp ƒë·∫∑t & hi·ªáu ch·ªânh', ver0: 6.2, latest: 6.8, version: 'V3' },
                    { item: 'CHI.05.40 - B·∫£o tr√¨ thi·∫øt b·ªã', ver0: 4.8, latest: 5.2, version: 'V3' },
                    { item: 'CHI.06.10 - Nh√¢n c√¥ng tr·ª±c ti·∫øp', ver0: 9.0, latest: 9.6, version: 'V3' },
                    { item: 'CHI.06.20 - Th·∫ßu ph·ª• k·∫øt c·∫•u', ver0: 8.4, latest: 9.0, version: 'V3' },
                    { item: 'CHI.06.30 - Th·∫ßu ph·ª• ho√†n thi·ªán', ver0: 8.8, latest: 9.4, version: 'V3' },
                    { item: 'CHI.06.40 - An to√†n & b·∫£o h·ªô lao ƒë·ªông', ver0: 5.2, latest: 5.7, version: 'V3' },
                    { item: 'CHI.07.10 - V·∫≠t t∆∞ ch√≠nh', ver0: 4.5, latest: 4.9, version: 'V3' },
                    { item: 'CHI.07.20 - V·∫≠t t∆∞ ph·ª•', ver0: 3.8, latest: 4.1, version: 'V3' },
                    { item: 'CHI.07.30 - V·∫≠n chuy·ªÉn & b·ªëc d·ª°', ver0: 4.2, latest: 4.6, version: 'V3' },
                    { item: 'CHI.07.40 - Nh√† cung c·∫•p chi·∫øn l∆∞·ª£c', ver0: 4.0, latest: 4.3, version: 'V3' },
                    { item: 'CHI.08.10 - V·∫≠n h√†nh c√¥ng tr∆∞·ªùng', ver0: 3.6, latest: 3.9, version: 'V3' },
                    { item: 'CHI.08.20 - Nhi√™n li·ªáu & nƒÉng l∆∞·ª£ng', ver0: 3.2, latest: 3.5, version: 'V3' },
                    { item: 'CHI.08.30 - B·∫£o v·ªá & an ninh', ver0: 2.8, latest: 3.0, version: 'V3' },
                    { item: 'CHI.08.40 - H·∫≠u c·∫ßn hi·ªán tr∆∞·ªùng', ver0: 3.4, latest: 3.7, version: 'V3' }
                ],
                approval: { revenue: 548, cost: 382, net: 166, fhi: 2.05 }
            }
        };

        const page2ProjectCompare = {
            total: {
                revenue: { ver0: [115, 106, 98, 128, 90], latest: [120, 110, 105, 135, 95] },
                cost: { ver0: [72, 68, 64, 84, 60], latest: [80, 75, 70, 90, 65] }
            },
            detail: {
                revenue: { ver0: [112, 104, 96, 125, 88], latest: [118, 108, 102, 130, 92] },
                cost: { ver0: [70, 66, 62, 82, 58], latest: [78, 72, 68, 88, 63] }
            }
        };

        const p2RevenueChart = new Chart(document.getElementById('chartP2Revenue'), {
            type: 'bar',
            data: {
                labels: projects,
                datasets: [
                    { label: 'Ver 0', data: [], backgroundColor: '#9AE6B4' },
                    { label: 'Ver Latest', data: [], backgroundColor: '#10B981' }
                ]
            },
            options: { ...chartConfig, scales: { y: { beginAtZero: true, ticks: { color: colors.gray } }, x: { ticks: { color: colors.gray } } } }
        });

        const p2CostChart = new Chart(document.getElementById('chartP2Cost'), {
            type: 'bar',
            data: {
                labels: projects,
                datasets: [
                    { label: 'Ver 0', data: [], backgroundColor: '#FCA5A5' },
                    { label: 'Ver Latest', data: [], backgroundColor: '#DC2626' }
                ]
            },
            options: { ...chartConfig, scales: { y: { beginAtZero: true, ticks: { color: colors.gray } }, x: { ticks: { color: colors.gray } } } }
        });

        function formatDelta(value) {
            const sign = value >= 0 ? '+' : '';
            return sign + value.toFixed(1) + ' T·ª∑';
        }

        function renderPage2(mode) {
            const data = budgetCompare[mode];
            const revDelta = data.revenue.latest - data.revenue.ver0;
            const revPct = (revDelta / data.revenue.ver0) * 100;
            const costDelta = data.cost.latest - data.cost.ver0;
            const costPct = (costDelta / data.cost.ver0) * 100;

            document.getElementById('p2RevenueVer0').textContent = data.revenue.ver0.toFixed(1) + ' T·ª∑';
            document.getElementById('p2RevenueLatest').textContent = data.revenue.latest.toFixed(1) + ' T·ª∑';
            document.getElementById('p2RevenueDelta').textContent = formatDelta(revDelta);
            document.getElementById('p2RevenueDeltaPct').textContent = (revPct >= 0 ? '+' : '') + revPct.toFixed(1) + '%';

            document.getElementById('p2CostVer0').textContent = data.cost.ver0.toFixed(1) + ' T·ª∑';
            document.getElementById('p2CostLatest').textContent = data.cost.latest.toFixed(1) + ' T·ª∑';
            document.getElementById('p2CostDelta').textContent = formatDelta(costDelta);
            document.getElementById('p2CostDeltaPct').textContent = (costPct >= 0 ? '+' : '') + costPct.toFixed(1) + '%';

            const projectCompare = page2ProjectCompare[mode];
            p2RevenueChart.data.datasets[0].data = projectCompare.revenue.ver0;
            p2RevenueChart.data.datasets[1].data = projectCompare.revenue.latest;
            p2CostChart.data.datasets[0].data = projectCompare.cost.ver0;
            p2CostChart.data.datasets[1].data = projectCompare.cost.latest;
            p2RevenueChart.update();
            p2CostChart.update();

            const body = document.getElementById('p2DetailBody');
            const thuRows = data.table.filter(row => row.item.startsWith('THU.'));
            const chiRows = data.table.filter(row => row.item.startsWith('CHI.'));
            const rows = [];

            rows.push('<tr class="row-group"><td colspan="6">THU</td></tr>');
            thuRows.forEach(row => {
                const delta = row.latest - row.ver0;
                const pct = (delta / row.ver0) * 100;
                const adjust = Number.isFinite(row.adjust) ? row.adjust : (row.latest + delta * 0.4);
                rows.push(`<tr class="row-child"><td>${row.item}</td><td>${row.ver0.toFixed(1)}</td><td>${row.latest.toFixed(1)}</td><td>${delta.toFixed(1)}</td><td>${pct.toFixed(1)}%</td><td>${adjust.toFixed(1)}</td></tr>`);
            });

            rows.push('<tr class="row-group"><td colspan="6">CHI</td></tr>');
            chiRows.forEach(row => {
                const delta = row.latest - row.ver0;
                const pct = (delta / row.ver0) * 100;
                const adjust = Number.isFinite(row.adjust) ? row.adjust : (row.latest + delta * 0.4);
                rows.push(`<tr class="row-child"><td>${row.item}</td><td>${row.ver0.toFixed(1)}</td><td>${row.latest.toFixed(1)}</td><td>${delta.toFixed(1)}</td><td>${pct.toFixed(1)}%</td><td>${adjust.toFixed(1)}</td></tr>`);
            });

            body.innerHTML = rows.join('');

            document.getElementById('p2AfterRevenue').textContent = data.approval.revenue.toFixed(1) + ' T·ª∑';
            document.getElementById('p2AfterCost').textContent = data.approval.cost.toFixed(1) + ' T·ª∑';
            document.getElementById('p2AfterNet').textContent = data.approval.net.toFixed(1) + ' T·ª∑';
            document.getElementById('p2AfterFhi').textContent = data.approval.fhi.toFixed(2);

            const beforeRevenue = data.revenue.latest;
            const beforeCost = data.cost.latest;
            const beforeNet = beforeRevenue - beforeCost;
            const fhiRatio = data.approval.revenue ? (data.revenue.latest / data.approval.revenue) : 1;
            const beforeFhi = data.approval.fhi * fhiRatio;

            const deltaRevenue = data.approval.revenue - beforeRevenue;
            const deltaCost = data.approval.cost - beforeCost;
            const deltaNet = data.approval.net - beforeNet;
            const deltaFhi = data.approval.fhi - beforeFhi;

            document.getElementById('p2BeforeRevenue').textContent = beforeRevenue.toFixed(1) + ' T·ª∑';
            document.getElementById('p2BeforeCost').textContent = beforeCost.toFixed(1) + ' T·ª∑';
            document.getElementById('p2BeforeNet').textContent = beforeNet.toFixed(1) + ' T·ª∑';
            document.getElementById('p2BeforeFhi').textContent = beforeFhi.toFixed(2);

            function setDelta(el, delta, suffix, decimals) {
                const value = Number.isFinite(delta) ? delta : 0;
                const sign = value >= 0 ? '+' : '';
                const fixed = value.toFixed(decimals);
                el.textContent = `Œî ${sign}${fixed}${suffix}`;
                el.className = `kpi-sub kpi-delta ${value >= 0 ? 'positive' : 'negative'}`;
            }

            setDelta(document.getElementById('p2DeltaRevenue'), deltaRevenue, ' T·ª∑', 1);
            setDelta(document.getElementById('p2DeltaCost'), deltaCost, ' T·ª∑', 1);
            setDelta(document.getElementById('p2DeltaNet'), deltaNet, ' T·ª∑', 1);
            setDelta(document.getElementById('p2DeltaFhi'), deltaFhi, '', 2);
        }
        // PAGE 3 CHARTS - THU TH·ª∞C T·∫æ
        (function() {
            const canvas = document.getElementById('chart6');
            const ctx = canvas.getContext('2d');
            const actualValue = 10.4;
            const targetValue = 12.0;
            const percentageValue = Math.round((actualValue / targetValue) * 100);
            const maxValue = 100;

            function drawGauge() {
                const w = canvas.width;
                const h = canvas.height;
                const cx = w / 2;
                const cy = h * 0.65;
                const radius = Math.min(w * 0.35, h * 0.55);

                ctx.clearRect(0, 0, w, h);
                ctx.lineCap = 'round';

                const bands = [ { pct: 60, color: '#DC2626' }, { pct: 85, color: '#F59E0B' }, { pct: 100, color: '#10B981' } ];
                let startPct = 0;
                bands.forEach(b => {
                    const startAngle = Math.PI + Math.PI * (startPct / maxValue);
                    const endAngle = Math.PI + Math.PI * (b.pct / maxValue);
                    ctx.beginPath();
                    ctx.arc(cx, cy, radius, startAngle, endAngle, false);
                    ctx.strokeStyle = b.color;
                    ctx.lineWidth = Math.max(18, radius * 0.12);
                    ctx.stroke();
                    startPct = b.pct;
                });

                ctx.beginPath();
                ctx.arc(cx, cy, radius + 12, Math.PI, 0, false);
                ctx.strokeStyle = '#E5E7EB';
                ctx.lineWidth = 1;
                ctx.stroke();

                const angle = Math.PI + Math.PI * (percentageValue / maxValue);
                const nx = cx + Math.cos(angle) * (radius - 8);
                const ny = cy + Math.sin(angle) * (radius - 8);
                ctx.beginPath();
                ctx.moveTo(cx, cy);
                ctx.lineTo(nx, ny);
                ctx.strokeStyle = '#111827';
                ctx.lineWidth = 3;
                ctx.stroke();

                ctx.beginPath();
                ctx.arc(cx, cy, Math.max(7, radius * 0.08), 0, 2 * Math.PI);
                ctx.fillStyle = '#111827';
                ctx.fill();

                ctx.beginPath();
                ctx.arc(cx, cy, Math.max(5, radius * 0.06), 0, 2 * Math.PI);
                ctx.fillStyle = 'white';
                ctx.fill();

                ctx.font = "bold 28px 'Be Vietnam Pro'";
                ctx.fillStyle = percentageValue <= 60 ? '#DC2626' : (percentageValue <= 85 ? '#F59E0B' : '#10B981');
                ctx.textAlign = 'center';
                ctx.fillText(percentageValue + '%', cx, cy + radius * 0.35);

                ctx.font = "bold 13px 'Be Vietnam Pro'";
                ctx.fillStyle = '#111827';
                ctx.textAlign = 'center';
                ctx.fillText('Th·ª±c t·∫ø: ' + actualValue.toFixed(1) + ' T·ª∑', cx, cy + radius * 0.55);

                ctx.font = "11px 'Be Vietnam Pro'";
                ctx.fillStyle = '#6B7280';
                ctx.textAlign = 'center';
                ctx.fillText('K·∫ø ho·∫°ch: ' + targetValue.toFixed(1) + ' T·ª∑', cx, cy + radius * 0.72);
            }

            drawGauge();
            window.addEventListener('resize', drawGauge);
        })();

        new Chart(document.getElementById('chart7'), {
            type: 'line',
            data: {
                labels: ['T1', 'T2', 'T3', 'T4', 'T5', 'T6', 'T7', 'T8', 'T9', 'T10', 'T11', 'T12'],
                datasets: [
                    { label: 'K·∫ø Ho·∫°ch (T·ª∑)', data: [12.0, 12.0, 12.0, 12.0, 12.0, 12.0, 12.0, 12.0, 12.0, 12.0, 12.0, 12.0], borderColor: colors.success, borderWidth: 2, borderDash: [5, 5], pointRadius: 3 },
                    { label: 'Th·ª±c T·∫ø (T·ª∑)', data: [10.4, 10.8, 11.1, 11.6, 12.0, 12.5, 12.8, 13.2, 13.7, 14.1, 14.6, 15.0], borderColor: colors.primary, backgroundColor: 'rgba(220,38,38,0.1)', tension: 0.4, fill: true, borderWidth: 2.5, pointRadius: 3 }
                ]
            },
            options: { ...chartConfig, scales: { y: { beginAtZero: true, ticks: { color: colors.gray }, grid: { color: '#F3F4F6' } }, x: { ticks: { color: colors.gray } } } }
        });

        new Chart(document.getElementById('chart8'), {
            type: 'bar',
            data: {
                labels: ['T1', 'T2', 'T3', 'T4', 'T5', 'T6', 'T7', 'T8', 'T9', 'T10', 'T11', 'T12'],
                datasets: [
                    { label: 'NƒÉm Nay (T·ª∑)', data: [10.4, 10.8, 11.1, 11.6, 12.0, 12.5, 12.8, 13.2, 13.7, 14.1, 14.6, 15.0], backgroundColor: colors.primary },
                    { label: 'NƒÉm Ngo√°i (T·ª∑)', data: [9.6, 10.0, 10.2, 10.6, 10.9, 11.4, 11.7, 12.1, 12.5, 12.8, 13.1, 13.5], backgroundColor: colors.light }
                ]
            },
            options: { ...chartConfig, scales: { y: { beginAtZero: true, ticks: { color: colors.gray }, grid: { color: '#F3F4F6' } }, x: { ticks: { color: colors.gray, fontSize: 9 } } } }
        });

        new Chart(document.getElementById('chart8b'), {
            type: 'doughnut',
            data: {
                labels: ['T∆∞ v·∫•n (32.5%)', 'Rao s·ª± (25.3%)', 'B·∫£n quy·ªÅn & Kh√°c (14.9%)'],
                datasets: [
                    { data: [47.0, 36.6, 21.6], backgroundColor: ['#FCD34D', '#60A5FA', '#F472B6'] }
                ]
            },
            options: chartConfig
        });

        new Chart(document.getElementById('chart8c'), {
            type: 'bar',
            data: {
                labels: ['THU.01', 'THU.02', 'THU.03', 'THU.04'],
                datasets: [
                    { label: 'K·∫ø Ho·∫°ch (T·ª∑)', data: [100.0, 18.0, 14.0, 6.0], backgroundColor: colors.success },
                    { label: 'Th·ª±c T·∫ø (T·ª∑)', data: [105.2, 21.6, 16.5, 7.3], backgroundColor: colors.primary }
                ]
            },
            options: { ...chartConfig, indexAxis: 'y', scales: { x: { beginAtZero: true, ticks: { color: colors.gray }, grid: { color: '#F3F4F6' } }, y: { ticks: { color: colors.gray } } } }
        });

        // PAGE 4 CHARTS - CHI TH·ª∞C T·∫æ
        (function(){
            const canvas = document.getElementById('chart9');
            const ctx = canvas.getContext('2d');
            const actualValue = 87.4;
            const budgetValue = 142.3;
            const percentageValue = Math.round((actualValue / budgetValue) * 100);
            const maxValue = 100;

            function drawGauge4(){
                const parent = canvas.parentElement;
                if (parent) {
                    const width = parent.clientWidth;
                    const height = parent.clientHeight;
                    if (width > 0 && height > 0) {
                        canvas.width = width;
                        canvas.height = height;
                    }
                }
                const w = canvas.width; const h = canvas.height; const cx = w / 2; const cy = h * 0.65; const radius = Math.min(w * 0.35, h * 0.55);
                ctx.clearRect(0, 0, w, h);
                ctx.lineCap = 'round';
                const bands = [ {pct: 50, color: '#10B981'}, {pct: 80, color: '#F59E0B'}, {pct: 100, color: '#DC2626'} ];
                let sp = 0;
                bands.forEach(b => {
                    const sa = Math.PI + Math.PI * (sp / maxValue);
                    const ea = Math.PI + Math.PI * (b.pct / maxValue);
                    ctx.beginPath();
                    ctx.arc(cx, cy, radius, sa, ea, false);
                    ctx.strokeStyle = b.color;
                    ctx.lineWidth = Math.max(18, radius * 0.12);
                    ctx.stroke();
                    sp = b.pct;
                });

                ctx.beginPath();
                ctx.arc(cx, cy, radius + 12, Math.PI, 0, false);
                ctx.strokeStyle = '#E5E7EB';
                ctx.lineWidth = 1;
                ctx.stroke();

                const ang = Math.PI + Math.PI * (percentageValue / maxValue);
                const nx = cx + Math.cos(ang) * (radius - 8);
                const ny = cy + Math.sin(ang) * (radius - 8);
                ctx.beginPath();
                ctx.moveTo(cx, cy);
                ctx.lineTo(nx, ny);
                ctx.strokeStyle = '#111827';
                ctx.lineWidth = 3;
                ctx.stroke();

                ctx.beginPath();
                ctx.arc(cx, cy, Math.max(7, radius * 0.08), 0, 2 * Math.PI);
                ctx.fillStyle = '#111827';
                ctx.fill();
                ctx.beginPath();
                ctx.arc(cx, cy, Math.max(5, radius * 0.06), 0, 2 * Math.PI);
                ctx.fillStyle = 'white';
                ctx.fill();

                ctx.font = "bold 28px 'Be Vietnam Pro'";
                ctx.fillStyle = percentageValue <= 50 ? '#10B981' : (percentageValue <= 80 ? '#F59E0B' : '#DC2626');
                ctx.textAlign = 'center';
                ctx.fillText(percentageValue + '%', cx, cy + radius * 0.35);

                ctx.font = "bold 13px 'Be Vietnam Pro'";
                ctx.fillStyle = '#111827';
                ctx.textAlign = 'center';
                ctx.fillText('ƒê√£ chi: ' + actualValue.toFixed(1) + ' T·ª∑', cx, cy + radius * 0.55);

                ctx.font = "11px 'Be Vietnam Pro'";
                ctx.fillStyle = '#6B7280';
                ctx.textAlign = 'center';
                ctx.fillText('K·∫ø ho·∫°ch chi: ' + budgetValue.toFixed(1) + ' T·ª∑', cx, cy + radius * 0.72);
            }
            drawGauge4();
            window.addEventListener('resize', drawGauge4);
        })();

        new Chart(document.getElementById('chart10'), {
            type: 'doughnut',
            data: {
                labels: ['CHI.01 Ph√°p l√Ω', 'CHI.02 Ki·∫øn thi·∫øt', 'CHI.03 B√°n h√†ng', 'CHI.04 Chu·∫©n b·ªã', 'CHI.05 Thi·∫øt b·ªã', 'CHI.06 Nh√¢n c√¥ng & th·∫ßu ph·ª•', 'CHI.07 V·∫≠t t∆∞ & NCC', 'CHI.08 Ho·∫°t ƒë·ªông tr·ª±c ti·∫øp'],
                datasets: [{ data: [6.2, 14.2, 9.9, 7.5, 11.6, 27.0, 15.4, 8.2], backgroundColor: [colors.primary, colors.secondary, colors.accent, colors.warning, colors.success, '#FCD34D', '#60A5FA', '#9CA3AF'] }]
            },
            options: chartConfig
        });

        new Chart(document.getElementById('chart11'), {
            type: 'bar',
            data: {
                labels: ['CHI.01', 'CHI.02', 'CHI.03', 'CHI.04', 'CHI.05', 'CHI.06', 'CHI.07', 'CHI.08'],
                datasets: [
                    { label: 'K·∫ø ho·∫°ch (T·ª∑)', data: [6.8, 14.0, 11.0, 8.2, 11.5, 29.5, 15.5, 9.0], backgroundColor: colors.success },
                    { label: 'Th·ª±c t·∫ø (T·ª∑)', data: [6.4, 14.8, 10.3, 7.8, 12.0, 28.1, 16.0, 8.5], backgroundColor: colors.primary }
                ]
            },
            options: { ...chartConfig, indexAxis: 'y', scales: { x: { beginAtZero: true, ticks: { color: colors.gray }, grid: { color: '#F3F4F6' } }, y: { ticks: { color: colors.gray } } } }
        });

        new Chart(document.getElementById('chart11c'), {
            type: 'bar',
            data: {
                labels: ['T1', 'T2', 'T3', 'T4', 'T5', 'T6', 'T7', 'T8', 'T9', 'T10', 'T11', 'T12'],
                datasets: [
                    { label: 'K·∫ø ho·∫°ch (T·ª∑)', data: [8.0, 8.5, 8.8, 9.0, 9.2, 9.4, 9.6, 9.8, 9.7, 9.5, 9.3, 9.0], backgroundColor: colors.success },
                    { label: 'Th·ª±c t·∫ø (T·ª∑)', data: [7.4, 8.2, 8.9, 9.1, 9.0, 9.6, 9.8, 10.1, 9.4, 8.9, 8.4, 8.1], backgroundColor: colors.secondary }
                ]
            },
            options: { ...chartConfig, scales: { y: { beginAtZero: true, ticks: { color: colors.gray }, grid: { color: '#F3F4F6' } }, x: { ticks: { color: colors.gray, fontSize: 9 } } } }
        });

        new Chart(document.getElementById('chart11d'), {
            type: 'line',
            data: {
                labels: ['T1', 'T2', 'T3', 'T4', 'T5', 'T6', 'T7', 'T8', 'T9', 'T10', 'T11', 'T12'],
                datasets: [
                    { label: 'L≈©y k·∫ø nƒÉm nay (T·ª∑)', data: [7.4, 15.6, 24.5, 33.6, 42.6, 52.2, 62.0, 72.1, 81.5, 90.4, 98.8, 106.9], borderColor: colors.primary, backgroundColor: 'rgba(220,38,38,0.08)', tension: 0.35, fill: true, borderWidth: 2.5, pointRadius: 2 },
                    { label: 'L≈©y k·∫ø nƒÉm tr∆∞·ªõc (T·ª∑)', data: [6.8, 14.0, 22.0, 30.1, 38.0, 47.2, 56.1, 65.0, 73.4, 81.5, 89.0, 96.0], borderColor: colors.gray, backgroundColor: 'rgba(156,163,175,0.08)', tension: 0.35, fill: false, borderWidth: 2, pointRadius: 2, borderDash: [4, 4] }
                ]
            },
            options: { ...chartConfig, scales: { y: { beginAtZero: true, ticks: { color: colors.gray }, grid: { color: '#F3F4F6' } }, x: { ticks: { color: colors.gray } } } }
        });

        new Chart(document.getElementById('chartP3Trend'), {
            type: 'line',
            data: {
                labels: ['T1', 'T2', 'T3', 'T4', 'T5', 'T6', 'T7', 'T8', 'T9', 'T10', 'T11', 'T12'],
                datasets: [
                    { label: 'Ng√¢n s√°ch (T·ª∑)', data: [46, 46, 46, 46, 46, 46, 47, 47, 47, 47, 48, 48], borderColor: colors.success, borderDash: [6, 4], borderWidth: 2, pointRadius: 3 },
                    { label: 'Th·ª±c thu (T·ª∑)', data: [43, 44, 45, 46, 45, 47, 46, 47, 48, 47, 49, 48], borderColor: colors.primary, backgroundColor: 'rgba(220,38,38,0.08)', tension: 0.35, fill: true, borderWidth: 2.5, pointRadius: 3 }
                ]
            },
            options: { ...chartConfig, scales: { y: { beginAtZero: false, ticks: { color: colors.gray }, grid: { color: '#F3F4F6' } }, x: { ticks: { color: colors.gray } } } }
        });

        new Chart(document.getElementById('chartP3ByProject'), {
            type: 'bar',
            data: {
                labels: projects,
                datasets: [
                    { label: 'Thu ng√¢n s√°ch', data: p1RevenueTotal, backgroundColor: '#10B981' },
                    { label: 'Th·ª±c thu', data: p1ActualRevenue, backgroundColor: '#6EE7B7' }
                ]
            },
            options: { ...chartConfig, scales: { y: { beginAtZero: true, ticks: { color: colors.gray } }, x: { ticks: { color: colors.gray } } } }
        });

        const p3VarianceData = p1ActualRevenue.map((v, i) => v - p1RevenueTotal[i]);
        new Chart(document.getElementById('chartP3Variance'), {
            type: 'bar',
            data: {
                labels: projects,
                datasets: [{
                    label: 'Ch√™nh l·ªách thu',
                    data: p3VarianceData,
                    backgroundColor: p3VarianceData.map(v => v >= 0 ? '#10B981' : '#F87171')
                }]
            },
            options: { ...chartConfig, scales: { y: { ticks: { color: colors.gray }, grid: { color: '#F3F4F6' } }, x: { ticks: { color: colors.gray } } } }
        });

        const p3DetailRows = projects.map((name, i) => {
            const budget = p1RevenueTotal[i];
            const actual = p1ActualRevenue[i];
            const pct = (actual / budget) * 100;
            const trend = pct >= 100 ? '‚ñ≤ 4%' : '‚ñº 3%';
            return `<tr><td>${name}</td><td>${budget.toFixed(1)}</td><td>${actual.toFixed(1)}</td><td>${pct.toFixed(1)}%</td><td>${trend}</td></tr>`;
        });
        document.getElementById('p3DetailBody').innerHTML = p3DetailRows.join('');

        new Chart(document.getElementById('chartP4Trend'), {
            type: 'line',
            data: {
                labels: ['T1', 'T2', 'T3', 'T4', 'T5', 'T6', 'T7', 'T8', 'T9', 'T10', 'T11', 'T12'],
                datasets: [
                    { label: 'Ng√¢n s√°ch (T·ª∑)', data: [32, 32, 32, 33, 33, 33, 34, 34, 34, 35, 35, 35], borderColor: colors.success, borderDash: [6, 4], borderWidth: 2, pointRadius: 3 },
                    { label: 'Th·ª±c chi (T·ª∑)', data: [31, 32, 33, 34, 33, 34, 35, 34, 35, 34, 35, 34], borderColor: colors.primary, backgroundColor: 'rgba(220,38,38,0.08)', tension: 0.35, fill: true, borderWidth: 2.5, pointRadius: 3 }
                ]
            },
            options: { ...chartConfig, scales: { y: { beginAtZero: false, ticks: { color: colors.gray }, grid: { color: '#F3F4F6' } }, x: { ticks: { color: colors.gray } } } }
        });

        new Chart(document.getElementById('chartP4ByProject'), {
            type: 'bar',
            data: {
                labels: projects,
                datasets: [
                    { label: 'Chi ng√¢n s√°ch', data: p1CostTotal, backgroundColor: colors.primary },
                    { label: 'Th·ª±c chi', data: p1ActualCost, backgroundColor: colors.light }
                ]
            },
            options: { ...chartConfig, scales: { y: { beginAtZero: true, ticks: { color: colors.gray } }, x: { ticks: { color: colors.gray } } } }
        });

        const p4VarianceData = p1ActualCost.map((v, i) => v - p1CostTotal[i]);
        new Chart(document.getElementById('chartP4Variance'), {
            type: 'bar',
            data: {
                labels: projects,
                datasets: [{
                    label: 'Ch√™nh l·ªách chi',
                    data: p4VarianceData,
                    backgroundColor: p4VarianceData.map(v => v > 0 ? '#DC2626' : '#10B981')
                }]
            },
            options: { ...chartConfig, scales: { y: { ticks: { color: colors.gray }, grid: { color: '#F3F4F6' } }, x: { ticks: { color: colors.gray } } } }
        });

        new Chart(document.getElementById('chartP4Structure'), {
            type: 'bar',
            data: {
                labels: projects,
                datasets: [
                    { label: 'Ph√°p l√Ω', data: [6, 5, 5, 7, 4], backgroundColor: '#FCA5A5', stack: 'cost' },
                    { label: 'Ki·∫øn thi·∫øt', data: [20, 18, 16, 22, 14], backgroundColor: '#F87171', stack: 'cost' },
                    { label: 'B√°n h√†ng', data: [12, 10, 9, 13, 8], backgroundColor: '#FB7185', stack: 'cost' },
                    { label: 'Chu·∫©n b·ªã', data: [8, 7, 6, 9, 5], backgroundColor: '#F59E0B', stack: 'cost' },
                    { label: 'Thi·∫øt b·ªã', data: [10, 9, 8, 12, 7], backgroundColor: '#FCD34D', stack: 'cost' },
                    { label: 'Nh√¢n c√¥ng', data: [15, 14, 12, 18, 10], backgroundColor: '#60A5FA', stack: 'cost' },
                    { label: 'V·∫≠t t∆∞', data: [6, 5, 5, 7, 4], backgroundColor: '#93C5FD', stack: 'cost' },
                    { label: 'Tr·ª±c ti·∫øp', data: [3, 2, 2, 3, 2], backgroundColor: '#A7F3D0', stack: 'cost' }
                ]
            },
            options: {
                ...chartConfig,
                scales: {
                    x: { stacked: true, ticks: { color: colors.gray } },
                    y: { stacked: true, ticks: { color: colors.gray }, grid: { color: '#F3F4F6' } }
                }
            }
        });

        const p4DetailRows = projects.map((name, i) => {
            const budget = p1CostTotal[i];
            const actual = p1ActualCost[i];
            const delta = actual - budget;
            const risk = delta > 3 ? 'Cao' : (delta > 0 ? 'Trung b√¨nh' : 'Th·∫•p');
            const riskClass = delta > 3 ? 'risk-high' : (delta > 0 ? 'risk-medium' : 'risk-low');
            return `<tr><td>${name}</td><td>${budget.toFixed(1)}</td><td>${actual.toFixed(1)}</td><td>${delta.toFixed(1)}</td><td class="${riskClass}">${risk}</td></tr>`;
        });
        document.getElementById('p4DetailBody').innerHTML = p4DetailRows.join('');

        document.querySelectorAll('.toggle-btn').forEach(btn => {
            btn.addEventListener('click', () => {
                document.querySelectorAll('.toggle-btn').forEach(b => b.classList.remove('active'));
                btn.classList.add('active');
                renderPage2(btn.dataset.mode);
            });
        });

        renderPage2('total');

        document.querySelectorAll('.nav-item').forEach((item) => {
            item.addEventListener('click', (e) => {
                document.querySelectorAll('.nav-item').forEach(n => n.classList.remove('active'));
                document.querySelectorAll('.page').forEach(p => p.classList.remove('active'));
                e.target.closest('.nav-item').classList.add('active');
                document.getElementById('page' + item.dataset.page).classList.add('active');
                setTimeout(() => window.dispatchEvent(new Event('resize')), 100);
            });
        });
    </script>
</body>
</html>
